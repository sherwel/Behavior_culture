
<!DOCTYPE html>
<html>
<head>
	<title>后台管理系统</title>
             <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
             <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="keywords" content="" />
	<meta name="description" content="" />

	
    <!-- bootstrap -->
    <link href="/static/background/css/bootstrap/bootstrap.css" rel="stylesheet" />
    <link href="/static/background/css/bootstrap/bootstrap-responsive.css" rel="stylesheet" />
    <link href="/static/background/css/bootstrap/bootstrap-overrides.css" type="text/css" rel="stylesheet" />
    <link rel="stylesheet" href="/static/background/css/compiled/user-profile.css" type="text/css" media="screen" />
    <!-- libraries -->
    <link href="/static/background/css/lib/jquery-ui-1.10.2.custom.css" rel="stylesheet" type="text/css" />
    <link href="/static/background/css/lib/font-awesome.css" type="text/css" rel="stylesheet" />

    <!-- global styles -->
    <link rel="stylesheet" type="text/css" href="/static/background/css/layout.css">
    <link rel="stylesheet" type="text/css" href="/static/background/css/elements.css">
    <link rel="stylesheet" type="text/css" href="/static/background/css/icons.css">
      <link rel="stylesheet" type="text/css" href="/static/background/css/compiled/skins/dark.css">

    <!-- this page specific styles -->
    <link rel="stylesheet" href="/static/background/css/compiled/index.css" type="text/css" media="screen" />

    <!-- open sans font -->
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- lato font -->
    <link href='http://fonts.googleapis.com/css?family=Lato:300,400,700,900,300italic,400italic,700italic,900italic' rel='stylesheet' type='text/css'>

    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<!-- <body onload="loadtask(0);"> -->
<body onload="">
    <!-- navbar -->
    <header class="navbar navbar-inverse" role="banner">
        <div class="navbar-header">
            <button class="navbar-toggle" type="button" data-toggle="collapse" id="menu-toggler">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/background/mainpage"><img src="/static/background/img/logo.png"></a>
        </div>
        <ul class="nav navbar-nav pull-right hidden-xs">
            <li class="hidden-xs hidden-sm">
                <input class="search" type="text" />
            </li>
            <li class="notification-dropdown hidden-xs hidden-sm">
                <a href="#" class="trigger">
                    <i class="icon-warning-sign"></i>
                    <span class="count">0</span>
                </a>
                <div class="pop-dialog">
                    <div class="pointer right">
                        <div class="arrow"></div>
                        <div class="arrow_border"></div>
                    </div>
                    <div class="body">
                        <a href="#" class="close-icon"><i class="icon-remove-sign"></i></a>
                        <div class="notifications">
                            <h3>你有没有新信息</h3>
                        
                            <div class="footer">
                                <a href="#" class="logout">查看所有消息</a>
                            </div>
                        </div>
                    </div>
                </div>
            </li>
            <li class="notification-dropdown hidden-xs hidden-sm">
                <a href="#" class="trigger">
                    <i class="icon-envelope"></i>
                </a>
                <div class="pop-dialog">
                    <div class="pointer right">
                        <div class="arrow"></div>
                        <div class="arrow_border"></div>
                    </div>
                    <div class="body">
                        <a href="#" class="close-icon"><i class="icon-remove-sign"></i></a>
                        <div class="messages">
                            <h5>没有新消息</h5>
                    
                            <div class="footer">
                                <a href="#" class="logout">查看所有消息</a>
                            </div>
                        </div>
                    </div>
                </div>
            </li>
            <li class="dropdown">
                <a href="#" class="dropdown-toggle hidden-xs hidden-sm" data-toggle="dropdown">
                           {{username}}
                    <b class="caret"></b>
                </a>
                <ul class="dropdown-menu">
                    <li><a href="#personal-info.html">个人信息</a></li>
                    <li><a href="#">账号设置</a></li>
                    <li><a href="#">账单</a></li>
                    <li><a href="#">导出数据</a></li>
                    <li><a href="#">发送反馈</a></li>
                </ul>
            </li>
            <li class="settings hidden-xs hidden-sm">
                <a href="#" role="button">
                    <i class="icon-cog"></i>
                </a>
            </li>
            <li class="settings hidden-xs hidden-sm">
                <a href="/background/logout" role="button">
                    <i class="icon-share-alt"></i>
                </a>
            </li>
        </ul>
    </header>
    <!-- end navbar -->

    <!-- sidebar -->
    <div id="sidebar-nav">
        <ul id="dashboard-menu">
            <li class="active">
                <div class="pointer">
                    <div class="arrow"></div>
                    <div class="arrow_border"></div>
                </div>
                <a href="/background/mainpage">
                    <i class="icon-home"></i>
                    <span>首页</span>
                </a>
            </li>            
          <li>
                <a class="dropdown-toggle" href="#">
                    <i class="icon-sitemap"></i>
                    <span>学校</span>
                    <i class="icon-chevron-down"></i>
                </a>
                <ul class="submenu">
                    <li><a href="/background/schoolmanage/">学校列表</a></li>
            
                </ul>
            </li>
            <li>
                <a class="dropdown-toggle" href="tables.html">
                    <i class="icon-th-large"></i>
                    <span>班级</span>
                    <i class="icon-chevron-down"></i>
                </a>
                <ul class="submenu">
                    <li><a href="/background/classmanage/">班级列表</a></li>
                    <li><a href="#">表格</a></li>
                </ul>
            </li>
            <li>
                <a class="dropdown-toggle" href="#">
                    <i class="icon-group"></i>
                    <span>用户</span>
                    <i class="icon-chevron-down"></i>
                </a>
                <ul class="submenu">
                    <li><a href="/background/studentmanage/">学生列表</a></li>
                    <li><a href="#">教师列表</a></li>
                    <li><a href="#">家长列表</a></li>
                </ul>
            </li>
  　　 <li>
                <a class="dropdown-toggle" href="#">
                    <i class="icon-comment"></i>
                    <span>评价</span>
                    <i class="icon-chevron-down"></i>
                </a>
                <ul class="submenu">
                    <li><a href="#">学生评价</a></li>
                    <li><a href="#">教师评价</a></li>
                    <li><a href="#">家长评价</a></li>
                </ul>
            </li>
   
         
            <li>
                <a href="#">
                    <i class="icon-cog"></i>
                    <span>我的信息</span>
                </a>
            </li>
            <li>
                <a class="dropdown-toggle" href="#">
                    <i class="icon-share-alt"></i>
                    <span>其他</span>
                    <i class="icon-chevron-down"></i>
                </a>
                <ul class="submenu">
                    <li><a href="/background/logout">注销</a></li>
                </ul>
            </li>
        </ul>
    </div>
    <!-- end sidebar -->

	<!-- main container -->
    <div class="content">


 <div class="container-fluid">
     <div id="pad-wrapper">

            <div class="table-products section">
                <div class="row head">
                    <div class="col-md-12">
                        <h4>截止目前 <small>共有</small></h4>
                    </div>
                </div>
            </div>
     <div id="main-stats">
            
                <div class="row-fluid stats-row">

                    <div class="span3 stat">
                        <div class="data">
                            <span class="number">200</span>
                            所
                        </div>
                        <span class="date">学校使用数</span>
                    </div>
                    <div class="span3 stat">
                        <div class="data">
                            <span class="number">3000</span>
                            个
                        </div>
                        <span class="date">班级数量</span>
                    </div>
                    <div class="span3 stat">
                        <div class="data">
                            <span class="number">16543</span>
                            个
                        </div>
                        <span class="date">学生数量</span>
                    </div>
                     <div class="span3 stat">
                        <div class="data">
                            <span class="number">54322</span>
                            个
                        </div>
                        <span class="date">评价数量</span>
                    </div>
                </div>
            </div>
</div>
 <div id="pad-wrapper">
            <div class="table-products section">
                <div class="row head">
                    <div class="col-md-12">
                        <h4>使用说明 <small>：</small></h4>
                    </div>
                </div>
            </div>

                    <!-- bio, new note & orders column -->
                    <div class="span9 bio">
                        <div class="profile-box">
                            <!-- biography -->
                            <div class="span12 section">
                                <h6>参考</h6>
                                <p>在侧边栏点击对应的链接进行相关操作. </p>
                            </div>
                        </div>
                           </div>
                            
</div>





                    </div>
                </div>


	<!-- scripts -->
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script src="/static/background/js/bootstrap.min.js"></script>
    <script src="/static/background/js/jquery-ui-1.10.2.custom.min.js"></script>
    <!-- knob -->
    <script src="/static/background/js/jquery.knob.js"></script>
    <!-- flot charts -->
    <script src="/static/background/js/jquery.flot.js"></script>
    <script src="/static/background/js/jquery.flot.stack.js"></script>
    <script src="/static/background/js/jquery.flot.resize.js"></script>
    <script src="/static/background/js/theme.js"></script>
  <script  language="javascript">
        var xmlhttp;
        var message=''
        var currpage=1;
        var nextpagehtml;
        var pagesize=0;
        var nowpage=0;
        var jobs=null;
        //创建XMLHttpRequest对象
        function GetXmlHttp(xmlhttp){
            if(window.XMLHttpRequest) //非IE浏览器，用xmlhttprequest对象创建
            {
                xmlhttp=new XMLHttpRequest();
            }
            else if(window.ActiveXObject) //IE浏览器用activexobject对象创建
            {

                try{
                    xmlhttp = new ActiveXObject("Msxml2.XMLHTTP.3.0");
                }catch(e){
                    try{
                        xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
                    }catch(e){


                    }
                }
            }
            return xmlhttp;
        }

        function loadtask(currpage) {
            xmlhttp= GetXmlHttp(xmlhttp);
            var number=currpage;
            var str='';
            str='page='+number+'&username='+message;
            nowpage=currpage;
            xmlhttp.open("POST","/background/jobshow/",false);
            xmlhttp.onreadystatechange = callback;
            xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
            xmlhttp.send(str);   
        }
        function callback(){

            if(xmlhttp.readyState!=4){

                document.getElementById("head").innerHTML = "<font color='red'>数据加载中...</font>" ;
            }
            else{

                if(xmlhttp.status == 200){

                    var a=xmlhttp.responseText;
                    infoshow(a);
                }
            }
        }
function startjob(taskid){
            localjobid=jobs[taskid].jobid;
            xmlhttp= GetXmlHttp(xmlhttp);
            var str='';
            str='taskid='+localjobid;
            xmlhttp.open("POST","/background/jobstart/",false);
            xmlhttp.onreadystatechange = jobcallback;
            xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
            xmlhttp.send(str);   
}
function pausejob(taskid){
            localjobid=jobs[taskid].jobid;
            xmlhttp= GetXmlHttp(xmlhttp);
            var str='';
            str='taskid='+localjobid;
            xmlhttp.open("POST","/background/jobpause/",false);
            xmlhttp.onreadystatechange = jobcallback;
            xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
            xmlhttp.send(str);   
}

function destroyjob(taskid){
            localjobid=jobs[taskid].jobid;
            xmlhttp= GetXmlHttp(xmlhttp);
            var str='';
            str='taskid='+localjobid;
            xmlhttp.open("POST","/background/jobdestroy/",false);
            xmlhttp.onreadystatechange = jobcallback;
            xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
            xmlhttp.send(str);   
}
    function jobcallback(){

            if(xmlhttp.readyState!=4){

               
            }
            else{

                if(xmlhttp.status == 200){

                    var a=xmlhttp.responseText;
                          var data2=JSON.parse(a);

                     if(data2.result=='1'){

                         window.location.reload();
                     }
                    else{
                        alert('操作失败');
                    }

                }
            }
        }
 function infoshow(a)
        {



            var data2=JSON.parse(a);
            var result=data2.result;
            var datalength=data2.length;
            var pagesize=data2.pagecount;
            var nowpage=data2.page
             jobs=data2.jobs;
            currpage=Number(nowpage)+1;
              var bodyhtml = "";
            
         
            if(result!='0') {

      


             

                for (var i = 0; i < datalength; i++) {
                     var labelstatus=''
                     var Active='';
                     statuss=jobs[i].jobstatus;

                     switch(statuss){
                        case '1':Active='未启动';labelstatus='default';break;
                        case '2':Active='正在排队';labelstatus='info';break;
                        case '3':Active='正在执行';labelstatus='primary';break;
                        case '4':Active='挂起';labelstatus='warning';break;
                        case '5':Active='已完成';labelstatus='success';break;
                        case '6':Active='已终止';labelstatus='danger';break;
                        default:Active='未知';labelstatus='danger';break;
                     }

             
                     var temport=''
                     if (jobs[i].jobport==''){
                        temport='全部可用端口';
                     }
                     else
                        temport=jobs[i].jobport;
                     bodyhtml+="<tr>"+
                                        "<td><input type=\"checkbox\">"+
                                            "<div class=\"img\"><img src=\"/static/background/img/owl.png\"></div>"+
                                            "<a href=\"/background/taskdetail?jobid="+jobs[i].jobid+"\">"+jobs[i].jobname +"</a></td>"+
                                        "<td class=\"description\">"+jobs[i].jobaddress+"</td>"+
                                        "<td class=\"description\">"+temport+"</td>"+
                                        "<td><span class=\"label label-"+labelstatus+"\">"+Active+"</span><ul class=\"actions\">"+
                                     
                                            "<li onclick='startjob("+i+");'><i class=\"table-start\" ></i></li>"+
                                            "<li onclick='pausejob("+i+");'><i class=\"table-pause\"></i></li>"+
                                            "<li><i class=\"table-edit\"></i></li>"+
                                            "<li><i class=\"table-settings\"></i></li>"+
                                            "<li class=\"last\" onclick='destroyjob("+i+");'><i class=\"table-delete\"></i></li>"+
                                            "</ul>"+
                                         "</td>"+
                                        "</tr>";

                }
                document.getElementById("head").innerHTML = bodyhtml;
            }
            var pagehtml="";
  
            if(pagesize>0){


                    if (currpage <=1) {
                
                    pagehtml+= "<li class=\"active\"><a onclick='loadtask(" + (currpage - 1).toString() + ");' href='javascript:void(0);'>1</a></li>";
                    

                    
                     }else {
              
                         pagehtml+= "<li ><a onclick='loadtask(" + (currpage - 2).toString() + ");' href='javascript:void(0);'>&laquo;</a></li>";
                         pagehtml+= "<li ><a onclick='loadtask(" + (currpage - 2).toString() + ");' href='javascript:void(0);'>"+(currpage-1).toString()+"</a></li>";
                         pagehtml+= "<li class=\"active\"><a onclick='loadtask(" + (currpage - 1).toString() + ");' href='javascript:void(0);'>"+currpage.toString()+"</a></li>";
                     }
                    if(pagesize-currpage==1){
                     pagehtml+= "<li ><a onclick='loadtask(" + (currpage).toString() + ");' href='javascript:void(0);'>"+(currpage+1).toString()+"</a></li>";
                      pagehtml+= "<li ><a onclick='loadtask(" + (currpage).toString() + ");' href='javascript:void(0);'>&raquo;</a></li>";
                     }
                     else if(pagesize-currpage>=2){
                     pagehtml+= "<li ><a onclick='loadtask(" + (currpage ) + ");' href='javascript:void(0);'>"+(currpage+1).toString()+"</a></li>";
                     pagehtml+= "<li ><a onclick='loadtask(" + (currpage+1 ) + ");' href='javascript:void(0);'>"+(currpage+2).toString()+"</a></li>";
                     pagehtml+= "<li ><a onclick='loadtask(" + (currpage ) + ");' href='javascript:void(0);'>&raquo;</a></li>";
                     }
                  


                
            }

            document.getElementById("page").innerHTML = pagehtml;

        }
            


        function createdata(){


            var jobname= document.getElementById("jobname").value;
            var jobaddress= document.getElementById("jobaddress").value;
            var jobport= document.getElementById("jobport").value;
            var priority= document.getElementById("priority").value;
            var abstract=  document.getElementById("abstract").value;

            xmlhttp= GetXmlHttp(xmlhttp);

            xmlhttp.open("POST","/background/jobadd/",true);
            xmlhttp.onreadystatechange = createcallback;
            var str='jobname='+jobname+'&jobaddress='+jobaddress+'&jobport='+jobport+'&priority='+priority+'&abstract='+abstract;
            xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
            xmlhttp.send(str);

        }
       function createcallback(){

            if(xmlhttp.readyState!=4){

                // document.getElementById("head").innerHTML = "<font color='red'>数据加载中...</font>"  ;
            }
            else{

                if(xmlhttp.status == 200){

                    var a=xmlhttp.responseText;
                        var data2=JSON.parse(a);

                     if(data2.result=='1'){

                         window.location.reload();
                     }
                    else{
                        alert('添加失败');
                    }

                }
            }
        }



</script>
    
  

</body>
</html>